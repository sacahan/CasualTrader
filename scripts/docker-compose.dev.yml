version: '3.8'

# Development configuration for Docker Compose
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  casualtrader:
    build:
      context: ..
      dockerfile: scripts/Dockerfile
      # Use cache for faster builds in development
      cache_from:
        - casualtrader:latest

    environment:
      # Development environment
      - ENVIRONMENT=development
      - DEBUG=true

      # CORS - allow all origins in development
      - CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8000

    ports:
      # Expose additional ports for debugging if needed
      - "8000:8000"

    volumes:
      # Mount source code for hot reload (if needed)
      # - ../backend/src:/app/src:ro
      - casualtrader-data:/app/data
      - casualtrader-logs:/app/logs

    # Override restart policy for development
    restart: "no"

    # Development logging
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
