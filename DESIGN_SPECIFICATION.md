# AI è‚¡ç¥¨äº¤æ˜“æ¨¡æ“¬å™¨ - è¨­è¨ˆè¦æ ¼æ›¸

**ç‰ˆæœ¬**: 2.0
**æ—¥æœŸ**: 2025-01-10
**å°ˆæ¡ˆ**: CasualTrader AI Trading Simulator

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

### ç”¢å“é¡˜æ™¯

æ‰“é€ ä¸€å€‹å³æ™‚ã€å¯è¦–åŒ–çš„ AI è‚¡ç¥¨äº¤æ˜“æ¨¡æ“¬å™¨ï¼Œä½¿ç”¨ OpenAI Agent SDK æ§‹å»ºæ™ºèƒ½äº¤æ˜“ä»£ç†äººï¼Œæ”¯æ´å¤šç¨® AI æ¨¡å‹åŒæ™‚é€²è¡Œè‚¡ç¥¨äº¤æ˜“ï¼Œæä¾›è§€æˆ°ã€åˆ†æå’Œå­¸ç¿’çš„å¹³å°ã€‚

### æ ¸å¿ƒåƒ¹å€¼

- **AI ç«¶æŠ€å ´**ï¼šå¤š AI æ¨¡å‹äº¤æ˜“ç­–ç•¥ç«¶è³½
- **å³æ™‚è§€æˆ°**ï¼šå¯¦æ™‚è§€å¯Ÿ AI æ±ºç­–å’ŒåŸ·è¡Œéç¨‹
- **æ•™è‚²åƒ¹å€¼**ï¼šé€šé AI è¡Œç‚ºå­¸ç¿’æŠ•è³‡ç­–ç•¥
- **ç­–ç•¥åˆ†æ**ï¼šæ¯”è¼ƒä¸åŒæŠ•è³‡æ–¹æ³•çš„æ•ˆæœ
- **æ™ºèƒ½æ±ºç­–**ï¼šAI ä»£ç†äººåŸºæ–¼å¸‚å ´æ•¸æ“šå’Œç ”ç©¶åˆ†æé€²è¡Œè‡ªä¸»äº¤æ˜“
- **ç­–ç•¥æŒä¹…åŒ–**ï¼šæŠ•è³‡ç­–ç•¥å’Œæ±ºç­–éç¨‹å®Œæ•´è¨˜éŒ„èˆ‡è¿½è¹¤

---

## ğŸ¯ åŠŸèƒ½éœ€æ±‚è¦æ ¼

### 1. AI ä»£ç†äººç®¡ç†ç³»çµ± (åŸºæ–¼ OpenAI Agent SDK)

#### 1.1 ä»£ç†äººç”Ÿå‘½é€±æœŸç®¡ç†

- **å‰µå»ºä»£ç†äºº**
  - æ”¯æ´è‡ªå®šç¾©åç¨±ã€ç­–ç•¥é¡å‹ã€é¡è‰²ä¸»é¡Œ
  - é è¨­åˆå§‹è³‡é‡‘ï¼šTWD 1,000,000
  - æ”¯æ´çš„ AI æ¨¡å‹ï¼šGPT-4o-mini, GPT-4o, DeepSeek, Grok, Gemini
  - SQLiteSession æœƒè©±æŒä¹…åŒ–ç®¡ç†

- **ä»£ç†äººç‹€æ…‹æ§åˆ¶**
  - å•Ÿå‹•/åœæ­¢äº¤æ˜“
  - æš«åœ/æ¢å¾©æ“ä½œ
  - å‹•æ…‹ç­–ç•¥èª¿æ•´èˆ‡é‡è¨­
  - è³‡é‡‘é‡ç½®
  - äº¤æ˜“æ™‚é–“é©—è­‰ï¼ˆå°ç£é›†ä¸­å¸‚å ´äº¤æ˜“æ™‚é–“ï¼šé€±ä¸€è‡³é€±äº” 09:00-13:30ï¼‰

#### 1.2 Agent å‰µå»ºèˆ‡é…ç½®ç³»çµ±

ç³»çµ±æ”¯æ´å¾å‰ç«¯å‹•æ…‹å‰µå»º AI Agentï¼Œæ¯å€‹ Agent çš„é…ç½®åŒ…å«ï¼š

- **Agent åç¨±**ï¼šä½¿ç”¨è€…è‡ªå®šç¾©çš„ Agent åç¨±
- **AI æ¨¡å‹**ï¼šGPT-4o-mini, GPT-4o, DeepSeek, Grok, Gemini
- **ç­–ç•¥ Prompt**ï¼šå®Œå…¨è‡ªè¨‚çš„æŠ•è³‡ç­–ç•¥æè¿°ï¼ˆæ”¯æ´é è¨­æ¨¡æ¿ï¼‰
- **ä¸»é«”é¡è‰²**ï¼šAgent åœ¨å‰ç«¯çš„è­˜åˆ¥è‰²å½©
- **åˆå§‹è³‡é‡‘**ï¼šAgent çš„èµ·å§‹æŠ•è³‡é‡‘é¡

#### 1.3 ç­–ç•¥ Prompt ç³»çµ±

ç­–ç•¥é€éç´”æ–‡å­— prompt å®šç¾©ï¼Œæ”¯æ´ï¼š

**Prompt Template ç¯„ä¾‹** (ç”¨æ–¼é‡è¨­å’Œåˆå§‹å€¼)ï¼š

```text
ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„ç©©å¥å‹æŠ•è³‡è€…ï¼ŒæŠ•è³‡ç›®æ¨™æ˜¯é•·æœŸç©©å®šå¢å€¼ï¼Œé¢¨éšªåå¥½è¼ƒä½ã€‚

æŠ•è³‡åŸå‰‡ï¼š
- å„ªå…ˆè€ƒæ…®å¤§å‹ç¸¾å„ªè‚¡å’Œé‡‘èè‚¡
- æ³¨é‡å…¬å¸è²¡å‹™ç©©å¥æ€§å’Œè‚¡æ¯é…ç™¼ç´€éŒ„
- é¿å…é«˜æ³¢å‹•æ€§å’ŒæŠ•æ©Ÿæ€§è‚¡ç¥¨
- åˆ†æ•£æŠ•è³‡é™ä½é¢¨éšª

æ±ºç­–æ™‚è«‹è€ƒæ…®ï¼š
1. å…¬å¸åŸºæœ¬é¢åˆ†æï¼ˆè²¡å‹™æŒ‡æ¨™ã€ç‡Ÿæ”¶ç©©å®šæ€§ï¼‰
2. è‚¡æ¯æ®–åˆ©ç‡å’Œé…ç™¼ç´€éŒ„
3. ç”¢æ¥­åœ°ä½å’Œç«¶çˆ­å„ªå‹¢
4. ç¶“æ¿Ÿç’°å¢ƒå°è©²ç”¢æ¥­çš„å½±éŸ¿

ä½ çš„æŠ•è³‡çµ„åˆç›®æ¨™æ˜¯ç©©å®šæˆé•·ï¼Œä¿è­·è³‡æœ¬ç‚ºå„ªå…ˆè€ƒé‡ã€‚
```

**å‹•æ…‹ç­–ç•¥èª¿æ•´**ï¼š

- Agent å¯ä»¥æ ¹æ“šå¸‚å ´æƒ…æ³å‹•æ…‹èª¿æ•´ç­–ç•¥
- æ‰€æœ‰ç­–ç•¥è®Šæ›´éƒ½æœƒæŒä¹…åŒ–è¨˜éŒ„
- æä¾›é‡è¨­ç‚ºåˆå§‹ Template çš„åŠŸèƒ½

#### 1.4 Agent å¯¦ä½œæ–¹å¼

```python
from agents import Agent

def create_trading_agent(agent_config: dict):
    """æ ¹æ“šå‰ç«¯é…ç½®å‰µå»º Trading Agent"""

    # å‰µå»º Agent å¯¦ä¾‹
    agent = Agent(
        name=agent_config["name"],
        model=agent_config["ai_model"],
        instructions=agent_config["strategy_prompt"],  # ç›´æ¥ä½¿ç”¨ä½¿ç”¨è€…è¼¸å…¥çš„ prompt
    )

    # é…ç½®æ‰€æœ‰å¯ç”¨å·¥å…·ï¼ˆç„¡éœ€é™åˆ¶ï¼‰
    configure_all_tools(agent)

    return agent

def configure_all_tools(agent: Agent):
    """ç‚º Agent é…ç½®æ‰€æœ‰å¯ç”¨å·¥å…·"""
    # æ‰€æœ‰å·¥å…·éƒ½é–‹æ”¾çµ¦ Agent ä½¿ç”¨
    tools = [
        MarketMCPTool(),           # å¸‚å ´æ•¸æ“šèˆ‡äº¤æ˜“
        WebSearchTool(),           # ç¶²è·¯æœå°‹
        ResearchAgentTool(),       # é‡‘èç ”ç©¶å“¡ Agent
        TimeValidatorTool(),       # äº¤æ˜“æ™‚é–“é©—è­‰
        FundValidatorTool(),       # è³‡é‡‘é©—è­‰
        RiskCalculatorTool(),      # é¢¨éšªè¨ˆç®—
        PortfolioManagerTool(),    # æŠ•è³‡çµ„åˆç®¡ç†
        # æœªä¾†å¯æ“´å±•æ›´å¤š custom tools
    ]

    for tool in tools:
        agent.add_tool(tool)
```

#### 1.5 Agent-to-Tool æ¶æ§‹è¨­è¨ˆ

æ¡ç”¨ OpenAI Agent SDK çš„ agent-to-tool åŠŸèƒ½ï¼Œå°‡å°ˆæ¥­åŠŸèƒ½ Agent ä½œç‚ºå·¥å…·æä¾›çµ¦äº¤æ˜“ Agentï¼š

### åŸºç¤æ•¸æ“šå·¥å…· (Basic Tools)

#### ğŸ”§ **Market MCP Server** (å·²å¯¦ä½œ)

- **åŠŸèƒ½**ï¼šå°ç£è‚¡ç¥¨å³æ™‚åƒ¹æ ¼æŸ¥è©¢èˆ‡æ¨¡æ“¬äº¤æ˜“åŸ·è¡Œ
- **è·è²¬**ï¼š
  - `get_taiwan_stock_price(symbol)`: å–å¾—è‚¡ç¥¨å³æ™‚åƒ¹æ ¼
  - `buy_taiwan_stock(symbol, quantity)`: åŸ·è¡Œè²·å…¥æ“ä½œ
  - `sell_taiwan_stock(symbol, quantity)`: åŸ·è¡Œè³£å‡ºæ“ä½œ
- **ç‹€æ…‹**ï¼šâœ… å·²å¯¦ä½œ (ç¾æœ‰ market_mcp æ¨¡çµ„)

#### ğŸ”§ **WebSearchTool** (å…§å»ºå·¥å…·)

- **åŠŸèƒ½**ï¼šOpenAI Agent SDK å…§å»ºçš„ç¶²è·¯æœå°‹å·¥å…·
- **è·è²¬**ï¼š
  - æœå°‹ç¶²è·¯ä¸Šçš„å³æ™‚è³‡è¨Š
  - å–å¾—å¸‚å ´æ–°èå’Œå…¬å¸è³‡è¨Š
  - æä¾›æœ€æ–°çš„è²¡ç¶“è³‡è¨Š
- **ç‹€æ…‹**ï¼šâœ… å…§å»ºå·¥å…· (ç›´æ¥ä½¿ç”¨)
- **ä½¿ç”¨æ–¹å¼**ï¼š

  ```python
  from agents import WebSearchTool

  # ç›´æ¥åŠ å…¥ Agent çš„å·¥å…·åˆ—è¡¨
  tools = [WebSearchTool()]
  ```

### å°ˆæ¥­åŠŸèƒ½ Agent (Agent-as-Tool)

#### ğŸ¤– **é‡‘èç ”ç©¶å“¡ Agent** (éœ€è¦å¯¦ä½œ)

- **Agent å°ˆæ¥­**ï¼šå°ˆç²¾è²¡å‹™åˆ†æå’ŒæŠ•è³‡ç ”ç©¶
- **ä½œç‚ºå·¥å…·æä¾›çš„åŠŸèƒ½**ï¼š
  - `analyze_company_fundamentals(symbol)`: å…¬å¸åŸºæœ¬é¢åˆ†æ
  - `evaluate_financial_health(symbol)`: è²¡å‹™å¥åº·åº¦è©•ä¼°
  - `assess_industry_trends(sector)`: ç”¢æ¥­è¶¨å‹¢åˆ†æ
  - `generate_investment_recommendation(symbol, context)`: æŠ•è³‡å»ºè­°ç”Ÿæˆ
- **ç‹€æ…‹**ï¼šğŸ”¨ éœ€è¦ Custom å¯¦ä½œ
- **Agent è¨­å®š**ï¼š
  ```python
  research_agent = Agent(
      name="é‡‘èç ”ç©¶å“¡",
      model="gpt-4o",  # ä½¿ç”¨è¼ƒå¼·æ¨¡å‹é€²è¡Œåˆ†æ
      instructions="ä½ æ˜¯å°ˆæ¥­çš„é‡‘èç ”ç©¶å“¡ï¼Œæ“…é•·åŸºæœ¬é¢åˆ†æ..."
  )
  ```

#### ğŸ¤– **æŠ€è¡“åˆ†æå¸« Agent** (éœ€è¦å¯¦ä½œ)

- **Agent å°ˆæ¥­**ï¼šå°ˆç²¾æŠ€è¡“æŒ‡æ¨™å’Œåœ–è¡¨åˆ†æ
- **ä½œç‚ºå·¥å…·æä¾›çš„åŠŸèƒ½**ï¼š
  - `analyze_technical_indicators(symbol, timeframe)`: æŠ€è¡“æŒ‡æ¨™åˆ†æ
  - `identify_chart_patterns(symbol)`: åœ–è¡¨å‹æ…‹è­˜åˆ¥
  - `calculate_support_resistance(symbol)`: æ”¯æ’é˜»åŠ›è¨ˆç®—
  - `assess_momentum_signals(symbol)`: å‹•é‡è¨Šè™Ÿè©•ä¼°
- **ç‹€æ…‹**ï¼šğŸ”¨ éœ€è¦ Custom å¯¦ä½œ

#### ğŸ¤– **é¢¨éšªè©•ä¼°å¸« Agent** (éœ€è¦å¯¦ä½œ)

- **Agent å°ˆæ¥­**ï¼šå°ˆç²¾æŠ•è³‡çµ„åˆé¢¨éšªç®¡ç†
- **ä½œç‚ºå·¥å…·æä¾›çš„åŠŸèƒ½**ï¼š
  - `calculate_portfolio_risk(agent_id)`: æŠ•è³‡çµ„åˆé¢¨éšªè¨ˆç®—
  - `assess_position_sizing(symbol, portfolio_value)`: éƒ¨ä½å¤§å°å»ºè­°
  - `evaluate_correlation_risk(holdings)`: ç›¸é—œæ€§é¢¨éšªè©•ä¼°
  - `suggest_diversification(portfolio)`: åˆ†æ•£åŒ–å»ºè­°
- **ç‹€æ…‹**ï¼šğŸ”¨ éœ€è¦ Custom å¯¦ä½œ

### é©—è­‰èˆ‡ç®¡ç†å·¥å…· (Validation Tools)

#### ğŸ”§ **TimeValidatorTool** (éœ€è¦å¯¦ä½œ)

- **åŠŸèƒ½**ï¼šé©—è­‰å°ç£è‚¡å¸‚äº¤æ˜“æ™‚é–“
- **è·è²¬**ï¼š
  - `is_trading_hours()`: æª¢æŸ¥ç•¶å‰æ˜¯å¦ç‚ºäº¤æ˜“æ™‚é–“
  - `get_next_trading_session()`: å–å¾—ä¸‹æ¬¡äº¤æ˜“æ™‚é–“
- **ç‹€æ…‹**ï¼šğŸ”¨ éœ€è¦ Custom å¯¦ä½œ

#### ğŸ”§ **FundValidatorTool** (éœ€è¦å¯¦ä½œ)

- **åŠŸèƒ½**ï¼šé©—è­‰æŠ•è³‡è³‡é‡‘å……è¶³æ€§
- **è·è²¬**ï¼š
  - `check_buying_power(agent_id, amount)`: æª¢æŸ¥è³¼è²·åŠ›
  - `calculate_transaction_cost(symbol, quantity, price)`: è¨ˆç®—äº¤æ˜“æˆæœ¬
- **ç‹€æ…‹**ï¼šğŸ”¨ éœ€è¦ Custom å¯¦ä½œ

### Agent-to-Tool å¯¦ä½œç¯„ä¾‹ (åŸºæ–¼å®˜æ–¹æ–‡æª”)

```python
from agents import Agent, Runner, function_tool, WebSearchTool

# 1. å‰µå»ºå°ˆæ¥­åŠŸèƒ½ Agent
research_agent = Agent(
    name="é‡‘èç ”ç©¶å“¡",
    model="gpt-4o",
    instructions="""ä½ æ˜¯å°ˆæ¥­çš„é‡‘èç ”ç©¶å“¡ï¼Œå…·å‚™æ·±åšçš„è²¡å‹™åˆ†æèƒ½åŠ›ã€‚
    ä½ å°ˆç²¾æ–¼ï¼š
    - å…¬å¸åŸºæœ¬é¢åˆ†æ
    - è²¡å‹™å ±è¡¨è§£è®€
    - ç”¢æ¥­è¶¨å‹¢ç ”ç©¶
    - æŠ•è³‡åƒ¹å€¼è©•ä¼°

    è«‹åŸºæ–¼ä½¿ç”¨è€…æä¾›çš„è‚¡ç¥¨ä»£ç¢¼å’Œåˆ†æéœ€æ±‚ï¼Œæä¾›å®¢è§€ã€å°ˆæ¥­çš„åˆ†æå ±å‘Šã€‚"""
)

technical_agent = Agent(
    name="æŠ€è¡“åˆ†æå¸«",
    model="gpt-4o",
    instructions="""ä½ æ˜¯å°ˆæ¥­çš„æŠ€è¡“åˆ†æå¸«ï¼Œå°ˆç²¾æ–¼è‚¡ç¥¨æŠ€è¡“é¢åˆ†æã€‚
    ä½ å°ˆç²¾æ–¼ï¼š
    - æŠ€è¡“æŒ‡æ¨™åˆ†æ (RSI, MACD, KD ç­‰)
    - åœ–è¡¨å‹æ…‹è­˜åˆ¥
    - æ”¯æ’é˜»åŠ›ä½åˆ†æ
    - è¶¨å‹¢å’Œå‹•é‡åˆ†æ

    è«‹åŸºæ–¼è‚¡ç¥¨ä»£ç¢¼æä¾›æŠ€è¡“é¢åˆ†æå»ºè­°ã€‚"""
)

risk_agent = Agent(
    name="é¢¨éšªè©•ä¼°å¸«",
    model="gpt-4o",
    instructions="""ä½ æ˜¯å°ˆæ¥­çš„æŠ•è³‡é¢¨éšªè©•ä¼°å¸«ï¼Œå°ˆç²¾æ–¼æŠ•è³‡çµ„åˆé¢¨éšªç®¡ç†ã€‚
    ä½ å°ˆç²¾æ–¼ï¼š
    - æŠ•è³‡çµ„åˆé¢¨éšªè¨ˆç®—
    - ç›¸é—œæ€§åˆ†æ
    - éƒ¨ä½æ§åˆ¶å»ºè­°
    - åˆ†æ•£åŒ–ç­–ç•¥

    è«‹åŸºæ–¼æŠ•è³‡çµ„åˆè³‡è¨Šæä¾›é¢¨éšªè©•ä¼°å’Œå»ºè­°ã€‚"""
)

# 2. åŸºç¤å·¥å…·å®šç¾©
@function_tool
async def get_stock_price(symbol: str) -> str:
    """å–å¾—å°ç£è‚¡ç¥¨å³æ™‚åƒ¹æ ¼"""
    # å‘¼å«ç¾æœ‰çš„ market_mcp_server
    from market_mcp.tools.stock_price_tool import get_taiwan_stock_price
    result = await get_taiwan_stock_price(symbol)
    return f"{symbol} ç›®å‰åƒ¹æ ¼: {result}"

@function_tool
async def buy_taiwan_stock(symbol: str, quantity: int) -> str:
    """åŸ·è¡Œå°ç£è‚¡ç¥¨è²·å…¥æ“ä½œ"""
    # å‘¼å«ç¾æœ‰çš„ market_mcp_server
    from market_mcp.tools.stock_price_tool import buy_taiwan_stock
    result = await buy_taiwan_stock(symbol, quantity)
    return f"å·²è²·å…¥ {symbol} {quantity} è‚¡"

@function_tool
async def sell_taiwan_stock(symbol: str, quantity: int) -> str:
    """åŸ·è¡Œå°ç£è‚¡ç¥¨è³£å‡ºæ“ä½œ"""
    # å‘¼å«ç¾æœ‰çš„ market_mcp_server
    from market_mcp.tools.stock_price_tool import sell_taiwan_stock
    result = await sell_taiwan_stock(symbol, quantity)
    return f"å·²è³£å‡º {symbol} {quantity} è‚¡"

@function_tool
async def validate_trading_time() -> str:
    """é©—è­‰ç•¶å‰æ˜¯å¦ç‚ºå°ç£è‚¡å¸‚äº¤æ˜“æ™‚é–“"""
    # TODO: å¯¦ä½œäº¤æ˜“æ™‚é–“é©—è­‰
    import datetime
    import pytz

    taiwan_tz = pytz.timezone('Asia/Taipei')
    now = datetime.datetime.now(taiwan_tz)

    # ç°¡åŒ–ç‰ˆæœ¬ï¼šé€±ä¸€åˆ°é€±äº” 09:00-13:30
    if now.weekday() < 5 and 9 <= now.hour < 14:
        return "ç•¶å‰ç‚ºå°ç£è‚¡å¸‚äº¤æ˜“æ™‚é–“ï¼Œå¯ä»¥é€²è¡Œäº¤æ˜“"
    else:
        return "ç•¶å‰éå°ç£è‚¡å¸‚äº¤æ˜“æ™‚é–“ï¼Œç„¡æ³•é€²è¡Œäº¤æ˜“"

@function_tool
async def check_fund_availability(agent_id: str, amount: float) -> str:
    """æª¢æŸ¥ Agent è³‡é‡‘æ˜¯å¦å……è¶³"""
    # TODO: å¯¦ä½œè³‡é‡‘é©—è­‰ï¼Œæ•´åˆå¸³æˆ¶ç³»çµ±
    return f"Agent {agent_id} è³‡é‡‘å……è¶³ï¼Œå¯æŠ•è³‡ {amount} TWD"

# 3. å‰µå»ºäº¤æ˜“ Agent ä¸¦é…ç½®å·¥å…·
def create_trading_agent(agent_config: dict) -> Agent:
    """å‰µå»ºé…ç½®å®Œæ•´å·¥å…·çš„äº¤æ˜“ Agent"""

    trading_agent = Agent(
        name=agent_config["name"],
        model=agent_config["ai_model"],
        instructions=agent_config["strategy_prompt"],
        tools=[
            # åŸºç¤å·¥å…·
            get_stock_price,
            buy_taiwan_stock,
            sell_taiwan_stock,
            validate_trading_time,
            check_fund_availability,

            # OpenAI SDK å…§å»ºå·¥å…·
            WebSearchTool(),  # ç¶²è·¯æœå°‹å·¥å…·

            # å°ˆæ¥­ Agent ä½œç‚ºå·¥å…·
            research_agent.as_tool(
                tool_name="analyze_fundamentals",
                tool_description="åˆ†æè‚¡ç¥¨åŸºæœ¬é¢ï¼ŒåŒ…æ‹¬è²¡å‹™ç‹€æ³ã€æˆé•·æ½›åŠ›å’ŒæŠ•è³‡åƒ¹å€¼è©•ä¼°"
            ),
            technical_agent.as_tool(
                tool_name="analyze_technicals",
                tool_description="åˆ†æè‚¡ç¥¨æŠ€è¡“é¢ï¼ŒåŒ…æ‹¬æŠ€è¡“æŒ‡æ¨™ã€åœ–è¡¨å‹æ…‹å’Œè¶¨å‹¢åˆ†æ"
            ),
            risk_agent.as_tool(
                tool_name="assess_risk",
                tool_description="è©•ä¼°æŠ•è³‡çµ„åˆé¢¨éšªï¼Œæä¾›éƒ¨ä½æ§åˆ¶å’Œåˆ†æ•£åŒ–å»ºè­°"
            ),
        ]
    )

    return trading_agent

# 4. ä½¿ç”¨ç¯„ä¾‹
async def main():
    # å‰µå»ºäº¤æ˜“ Agent
    agent_config = {
        "name": "ç©©å¥æŠ•è³‡è€…",
        "ai_model": "gpt-4o-mini",
        "strategy_prompt": "ä½ æ˜¯ç©©å¥å‹æŠ•è³‡è€…ï¼Œé‡è¦–é¢¨éšªæ§åˆ¶..."
    }

    trading_agent = create_trading_agent(agent_config)

    # åŸ·è¡ŒæŠ•è³‡æ±ºç­–
    result = await Runner.run(
        trading_agent,
        "è«‹åˆ†æå°ç©é›»(2330)æ˜¯å¦é©åˆè²·å…¥ï¼Œæˆ‘çš„æŠ•è³‡çµ„åˆç›®å‰æœ‰100è¬ç¾é‡‘"
    )

    print(result.final_output)

# é‹è¡Œç¯„ä¾‹
import asyncio
asyncio.run(main())
```

### æ¶æ§‹å„ªå‹¢

1. **å°ˆæ¥­åˆ†å·¥**ï¼šæ¯å€‹ Agent å°ˆç²¾ç‰¹å®šé ˜åŸŸï¼Œæä¾›é«˜å“è³ªåˆ†æ
2. **æ¨¡çµ„åŒ–**ï¼šå¯ä»¥ç¨ç«‹é–‹ç™¼ã€æ¸¬è©¦å’Œå„ªåŒ–æ¯å€‹å°ˆæ¥­ Agent
3. **å¯æ“´å±•æ€§**ï¼šè¼•é¬†æ·»åŠ æ–°çš„å°ˆæ¥­ Agentï¼ˆå¦‚ç¸½é«”ç¶“æ¿Ÿåˆ†æå¸«ï¼‰
4. **æˆæœ¬å„ªåŒ–**ï¼šå¯ç‚ºä¸åŒ Agent é¸æ“‡ä¸åŒæ¨¡å‹ï¼ˆåˆ†æç”¨ GPT-4oï¼Œç°¡å–®ä»»å‹™ç”¨ GPT-4o-miniï¼‰
5. **é‡ç”¨æ€§**ï¼šå°ˆæ¥­ Agent å¯ä»¥è¢«å¤šå€‹äº¤æ˜“ Agent å…±äº«ä½¿ç”¨

### 2. å³æ™‚äº¤æ˜“ç›£æ§ç³»çµ±

#### 2.1 å¯¦æ™‚æ•¸æ“šæµ

- **WebSocket äº‹ä»¶é¡å‹**
  - `agent_status_update`: ä»£ç†äººç‹€æ…‹è®ŠåŒ–
  - `trade_executed`: äº¤æ˜“åŸ·è¡Œé€šçŸ¥
  - `portfolio_update`: æŠ•è³‡çµ„åˆæ›´æ–°
  - `research_activity`: ç ”ç©¶æ´»å‹•è¨˜éŒ„
  - `strategy_change`: ç­–ç•¥èª¿æ•´é€šçŸ¥
  - `investment_rationale`: æŠ•è³‡æ±ºç­–åŸå› è¨˜éŒ„
  - `fund_verification`: è³‡é‡‘é©—è­‰çµæœ
  - `trading_hours_check`: äº¤æ˜“æ™‚é–“é©—è­‰çµæœ

#### 2.2 äº¤æ˜“åŸ·è¡Œè¿½è¹¤èˆ‡é©—è­‰

- **äº¤æ˜“å‰é©—è­‰**
  - äº¤æ˜“æ™‚é–“æª¢æŸ¥ï¼šé€±ä¸€è‡³é€±äº” 09:00-13:30ï¼ˆå°ç£æ™‚é–“ï¼‰
  - è³‡é‡‘å……è¶³æ€§é©—è­‰ï¼šç¢ºèªè²·å…¥å‰ç¾é‡‘é¤˜é¡è¶³å¤ 
  - æŠ•è³‡ç­–ç•¥ç¬¦åˆæ€§æª¢æŸ¥ï¼šå–®ä¸€æŒè‚¡æ¯”ä¾‹é™åˆ¶
  - é¢¨éšªè©•ä¼°ï¼šæŠ•è³‡çµ„åˆé¢¨éšªåˆ†æ

- **è²·å…¥/è³£å‡ºæ“ä½œ**
  - å³æ™‚åƒ¹æ ¼ç²å–ï¼ˆå°ç£è­‰äº¤æ‰€ï¼‰
  - æ‰‹çºŒè²»è¨ˆç®— (0.2% spread)
  - äº¤æ˜“ç¢ºèªèˆ‡è¨˜éŒ„
  - æŠ•è³‡åŸå› æŒä¹…åŒ–è¨˜éŒ„
  - å‰ç«¯å‹•ç•«åé¥‹

#### 2.3 æŠ•è³‡æ±ºç­–è¿½è¹¤

- **æ±ºç­–è¨˜éŒ„ç³»çµ±**
  - æ¯ç­†äº¤æ˜“è¨˜éŒ„æŠ•è³‡åŸå› 
  - AI ä»£ç†äººæ±ºç­–éç¨‹è¨˜éŒ„
  - ç­–ç•¥èª¿æ•´æ­·å²è¿½è¹¤
  - å¸‚å ´åˆ†æçµæœä¿å­˜
  - å·¥å…·ä½¿ç”¨è¨˜éŒ„ï¼ˆWebSearchã€é‡‘èç ”ç©¶å“¡ Agent ç­‰ï¼‰

### 3. è¦–è¦ºåŒ–å„€è¡¨æ¿

#### 3.1 ä¸»å„€è¡¨æ¿

- **ä»£ç†äººå¡ç‰‡**
  - ç¸½è³‡ç”¢ã€æç›Šã€ç¾é‡‘é¤˜é¡
  - å³æ™‚è³‡ç”¢åƒ¹å€¼æ›²ç·šåœ–
  - æŒè‚¡åˆ†å¸ƒé¡¯ç¤º
  - ç‹€æ…‹æŒ‡ç¤ºç‡ˆï¼ˆé‹è¡Œ/åœæ­¢/ç ”ç©¶ä¸­ï¼‰

#### 3.2 è©³ç´°æ¨¡æ…‹è¦–çª—

- **è³‡ç”¢è®ŠåŒ–åœ–è¡¨**
  - Chart.js å¯¦ç¾
  - æ”¯æ´ç¸®æ”¾å’Œæ™‚é–“ç¯„åœé¸æ“‡
  - å¤šæ¢ä»¶ç¯©é¸

- **æŒè‚¡è©³æƒ…**
  - è‚¡ç¥¨ä»£ç¢¼ã€åç¨±ã€æŒæœ‰æ•¸é‡
  - å¹³å‡æˆæœ¬ã€ç•¶å‰åƒ¹æ ¼
  - æç›Šè¨ˆç®—

- **äº¤æ˜“æ­·å²**
  - æ™‚é–“åºåˆ—é¡¯ç¤º
  - è²·å…¥/è³£å‡ºæ¨™è¨˜
  - äº¤æ˜“åŸå› è¨˜éŒ„

### 4. å°ç£è‚¡å¸‚æ•´åˆ

#### 4.1 æ”¯æ´è‚¡ç¥¨ç¯„åœ

- **ä¸Šå¸‚è‚¡ç¥¨**: 4ä½æ•¸ä»£ç¢¼ (å¦‚: 2330, 2317)
- **ETF**: 4-6ä½æ•¸ + å­—æ¯ (å¦‚: 0050, 00646)
- **ç†±é–€æ¨™çš„**: å°ç©é›»ã€é´»æµ·ã€è¯ç™¼ç§‘ç­‰

#### 4.2 å¸‚å ´è³‡æ–™

- **å³æ™‚åƒ¹æ ¼**: é€é MCP æœå‹™å–å¾—
- **å…¬å¸è³‡è¨Š**: åç¨±ã€ç”¢æ¥­åˆ†é¡
- **äº¤æ˜“æ™‚é–“**: å°ç£è­‰äº¤æ‰€ç‡Ÿæ¥­æ™‚é–“

---

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹è¦æ ¼

### 1. ç³»çµ±æ¶æ§‹åœ–

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å‰ç«¯å±¤ (Frontend)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Vanilla JS  â”‚ â”‚ Chart.js    â”‚ â”‚ WebSocket Client    â”‚  â”‚
â”‚  â”‚ å„€è¡¨æ¿+è¨­å®š  â”‚ â”‚ åœ–è¡¨è¦–è¦ºåŒ–   â”‚ â”‚ å³æ™‚é€šä¿¡            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTP/WS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Web æœå‹™å±¤ (Backend)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FastAPI    â”‚ â”‚ WebSocket   â”‚ â”‚ éœæ…‹æª”æ¡ˆæœå‹™         â”‚  â”‚
â”‚  â”‚  REST API   â”‚ â”‚ å³æ™‚æ¨é€    â”‚ â”‚ Static Files        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ å…§éƒ¨èª¿ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI ä»£ç†äººå±¤ (Agent Layer)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ OpenAI      â”‚ â”‚ SQLite      â”‚ â”‚ Tool Manager        â”‚  â”‚
â”‚  â”‚ Agent SDK   â”‚ â”‚ Session     â”‚ â”‚ å·¥å…·é…ç½®ç®¡ç†         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Trading     â”‚ â”‚ Research    â”‚ â”‚ Risk Management     â”‚  â”‚
â”‚  â”‚ Agents      â”‚ â”‚ Agent       â”‚ â”‚ é¢¨éšªæ§åˆ¶            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ å·¥å…·èª¿ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å·¥å…·å±¤ (Tools Layer)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Market MCP  â”‚ â”‚ WebSearch   â”‚ â”‚ Trading Time        â”‚  â”‚
â”‚  â”‚ Server      â”‚ â”‚ Tool        â”‚ â”‚ Validator           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Fund        â”‚ â”‚ Portfolio   â”‚ â”‚ Strategy            â”‚  â”‚
â”‚  â”‚ Validator   â”‚ â”‚ Manager     â”‚ â”‚ Manager             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ è³‡æ–™å­˜å–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è³‡æ–™å±¤ (Data Layer)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Agent       â”‚ â”‚ Trading     â”‚ â”‚ Strategy &          â”‚  â”‚
â”‚  â”‚ Sessions    â”‚ â”‚ Records     â”‚ â”‚ Decision Logs       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Portfolio   â”‚ â”‚ Market      â”‚ â”‚ Configuration       â”‚  â”‚
â”‚  â”‚ Data        â”‚ â”‚ Data Cache  â”‚ â”‚ Database            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æŠ€è¡“å †ç–Š

#### 2.1 å¾Œç«¯æŠ€è¡“

```yaml
Webæ¡†æ¶: FastAPI 0.104+
AIä»£ç†äºº: OpenAI Agents SDK (Python)
æœƒè©±ç®¡ç†: SQLiteSession (Agent SDK å…§å»º)
è³‡æ–™åº«: SQLite 3.x
é€šä¿¡å”è­°: WebSocket, REST API
å¸‚å ´è³‡æ–™: MCP (Model Context Protocol)
éåŒæ­¥è™•ç†: asyncio, aiohttp
å·¥å…·æ•´åˆ: MCP Tools, WebSearch, Custom Tools
```

#### 2.2 AI ä»£ç†äººæŠ€è¡“

```yaml
æ¡†æ¶: OpenAI Agents Python SDK
æ”¯æ´æ¨¡å‹:
  - OpenAI GPT-4o-mini
  - OpenAI GPT-4o
  - DeepSeek API
  - Grok API
  - Google Gemini API
æœƒè©±æŒä¹…åŒ–: SQLiteSession
å¤šä»£ç†äººå”ä½œ: Agent Handoffs
å·¥å…·èª¿ç”¨: Function Calling
è¿½è¹¤ç³»çµ±: Built-in Tracing
```

#### 2.3 å‰ç«¯æŠ€è¡“

```yaml
æ ¸å¿ƒæ¡†æ¶: Vanilla JavaScript (ES2022+)
åœ–è¡¨åº«: Chart.js 4.x
æ¨£å¼æ¡†æ¶: Tailwind CSS 3.x
å­—é«”: Inter + Noto Sans TC
å³æ™‚é€šä¿¡: WebSocket API
æ¨¡çµ„ç³»çµ±: ES Modules
è¨­å®šç®¡ç†: æœ¬åœ°å„²å­˜ + å¾Œç«¯æŒä¹…åŒ–
```

#### 2.4 å¤–éƒ¨æœå‹™èˆ‡å·¥å…·

```yaml
è‚¡åƒ¹è³‡æ–™: å°ç£è­‰äº¤æ‰€ API (é€é MCP)
ç ”ç©¶å·¥å…·: WebSearch API
é‡‘èåˆ†æ: é‡‘èç ”ç©¶å“¡ Agent
æŠ€è¡“åˆ†æ: è‡ªå»ºæŠ€è¡“æŒ‡æ¨™å·¥å…·
é¢¨éšªç®¡ç†: æŠ•è³‡çµ„åˆåˆ†æå·¥å…·
æ™‚é–“é©—è­‰: å°ç£äº¤æ˜“æ™‚é–“æª¢æŸ¥
è³‡é‡‘é©—è­‰: é¤˜é¡æª¢æŸ¥å·¥å…·
```

### 3. è³‡æ–™æ¨¡å‹è¨­è¨ˆ

#### 3.1 AIä»£ç†äººæ¨¡å‹

```python
from agents import Agent, SQLiteSession
from pydantic import BaseModel
from datetime import datetime
from typing import Dict, Any, List

class TradingAgent(BaseModel):
    id: str
    name: str
    ai_model: str  # GPT-4o-mini, GPT-4o, DeepSeek, Grok, Gemini
    strategy_prompt: str  # å®Œæ•´ç­–ç•¥ promptï¼ˆä¾†è‡ªå‰ç«¯è¼¸å…¥ï¼‰
    color: str  # RGB values
    initial_balance: float
    current_balance: float
    portfolio_value: float
    status: AgentStatus  # running, stopped, researching, trading
    session_id: str  # SQLiteSession identifierï¼ˆèˆ‡è³‡æ–™åº«æ•´åˆï¼‰
    created_at: datetime
    last_active: datetime

class StrategyAdjustment(BaseModel):
    id: str
    agent_id: str
    timestamp: datetime
    old_prompt: str
    new_prompt: str
    reason: str
    agent_rationale: str
```

#### 3.2 äº¤æ˜“è¨˜éŒ„èˆ‡æ±ºç­–æ¨¡å‹

```python
class Transaction(BaseModel):
    id: str
    agent_id: str
    symbol: str
    company_name: str
    action: TradeAction  # BUY, SELL
    quantity: int
    price: float
    total_amount: float
    fees: float
    timestamp: datetime
    rationale: str  # AI æŠ•è³‡åŸå› 
    analysis_data: Dict[str, Any]  # åˆ†ææ•¸æ“š
    tools_used: List[str]  # ä½¿ç”¨çš„å·¥å…·è¨˜éŒ„
    pre_trade_validation: PreTradeValidation

class PreTradeValidation(BaseModel):
    trading_hours_valid: bool
    fund_sufficient: bool
    risk_acceptable: bool
    strategy_compliant: bool
    validation_timestamp: datetime
    validation_details: Dict[str, Any]

class InvestmentDecision(BaseModel):
    id: str
    agent_id: str
    decision_type: str  # research, buy, sell, hold, strategy_adjust
    timestamp: datetime
    reasoning: str
    data_sources: List[str]  # WebSearch, é‡‘èç ”ç©¶å“¡Agentç­‰
    market_context: Dict[str, Any]
    confidence_level: float  # 0.0 - 1.0

class Portfolio(BaseModel):
    agent_id: str
    holdings: Dict[str, HoldingInfo]
    cash_balance: float
    total_value: float
    risk_metrics: RiskMetrics
    last_updated: datetime

class HoldingInfo(BaseModel):
    symbol: str
    company_name: str
    quantity: int
    average_cost: float
    current_price: float
    market_value: float
    unrealized_pnl: float
    percentage_of_portfolio: float
    purchase_rationale: List[str]  # æ­·æ¬¡è²·å…¥åŸå› 

class RiskMetrics(BaseModel):
    concentration_risk: float  # é›†ä¸­åº¦é¢¨éšª
    sector_allocation: Dict[str, float]
    volatility_score: float
    diversification_score: float
```

#### 3.3 å¸‚å ´è³‡æ–™æ¨¡å‹

```python
class StockPrice(BaseModel):
    symbol: str
    price: float
    change: float
    change_percent: float
    timestamp: datetime

class MarketData(BaseModel):
    symbol: str
    company_name: str
    industry: str
    current_price: float
    day_high: float
    day_low: float
```

---

## ğŸ”„ API è¦æ ¼è¨­è¨ˆ

### 1. REST API ç«¯é»

#### 1.1 ä»£ç†äººç®¡ç†

```http
GET    /api/agents                    # å–å¾—æ‰€æœ‰ä»£ç†äºº
POST   /api/agents                    # å‰µå»ºæ–°ä»£ç†äºº
GET    /api/agents/{id}               # å–å¾—æŒ‡å®šä»£ç†äºº
PUT    /api/agents/{id}               # æ›´æ–°ä»£ç†äººè¨­å®š
DELETE /api/agents/{id}               # åˆªé™¤ä»£ç†äºº

POST   /api/agents/{id}/start         # å•Ÿå‹•ä»£ç†äºº
POST   /api/agents/{id}/stop          # åœæ­¢ä»£ç†äºº
PUT    /api/agents/{id}/strategy      # æ›´æ–°ç­–ç•¥
POST   /api/agents/{id}/reset         # é‡ç½®å¸³æˆ¶
```

#### 1.2 äº¤æ˜“èˆ‡å¸³æˆ¶

```http
GET    /api/agents/{id}/portfolio     # å–å¾—æŠ•è³‡çµ„åˆ
GET    /api/agents/{id}/transactions  # å–å¾—äº¤æ˜“æ­·å²
GET    /api/agents/{id}/performance   # å–å¾—ç¸¾æ•ˆæ•¸æ“š
```

#### 1.3 å¸‚å ´è³‡æ–™

```http
GET    /api/market/stocks             # å–å¾—è‚¡ç¥¨æ¸…å–®
GET    /api/market/stocks/{symbol}    # å–å¾—è‚¡ç¥¨è³‡è¨Š
GET    /api/market/price/{symbol}     # å–å¾—å³æ™‚åƒ¹æ ¼
```

### 2. WebSocket äº‹ä»¶è¦æ ¼

#### 2.1 äº‹ä»¶é¡å‹å®šç¾©

```typescript
interface WebSocketEvent {
  type:
    | "agent_status"
    | "trade_executed"
    | "portfolio_update"
    | "market_update";
  timestamp: string;
  data: any;
}

interface AgentStatusEvent {
  type: "agent_status";
  agent_id: string;
  status: "running" | "stopped" | "researching" | "trading";
  message?: string;
}

interface TradeExecutedEvent {
  type: "trade_executed";
  agent_id: string;
  trade: {
    action: "BUY" | "SELL";
    symbol: string;
    quantity: number;
    price: number;
    rationale: string;
  };
}
```

---

## ğŸ’» ç”¨æˆ¶ä»‹é¢è¦æ ¼

### 1. ä¸»å„€è¡¨æ¿è¨­è¨ˆ

#### 1.1 å¸ƒå±€çµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ¨™é¡Œåˆ—                           â”‚
â”‚          AI è‚¡ç¥¨äº¤æ˜“æ¨¡æ“¬å™¨ + è¨­å®šæŒ‰éˆ•                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ§åˆ¶é¢æ¿                           â”‚
â”‚     èªªæ˜æ–‡å­— + å…¨åŸŸæ§åˆ¶æŒ‰éˆ• (å…¨éƒ¨å•Ÿå‹•/åœæ­¢)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä»£ç†äººå¡ç‰‡ç¶²æ ¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Agent #1    â”‚ â”‚ Agent #2    â”‚ â”‚ Agent #3            â”‚  â”‚
â”‚  â”‚ ç©©å¥å‹      â”‚ â”‚ ç©æ¥µå‹      â”‚ â”‚ å¹³è¡¡å‹              â”‚  â”‚
â”‚  â”‚ [åœ–è¡¨]      â”‚ â”‚ [åœ–è¡¨]      â”‚ â”‚ [åœ–è¡¨]              â”‚  â”‚
â”‚  â”‚ [æŒè‚¡æ¸…å–®]  â”‚ â”‚ [æŒè‚¡æ¸…å–®]  â”‚ â”‚ [æŒè‚¡æ¸…å–®]          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2 ä»£ç†äººå¡ç‰‡å…ƒç´ 

- **æ¨™é¡Œå€åŸŸ**: ä»£ç†äººåç¨± + ç­–ç•¥é¡è‰²
- **æ•¸æ“šé¡¯ç¤º**: ç¸½è³‡ç”¢ã€æç›Šã€ç¾é‡‘é¤˜é¡
- **åœ–è¡¨å€åŸŸ**: Chart.js å³æ™‚è³‡ç”¢åƒ¹å€¼æ›²ç·š
- **æŒè‚¡åˆ—è¡¨**: ç•¶å‰æŒæœ‰è‚¡ç¥¨çš„ç°¡è¦ä¿¡æ¯
- **ç‹€æ…‹æŒ‡ç¤º**: é‹è¡Œç‹€æ…‹çš„è¦–è¦ºæŒ‡ç¤ºå™¨

### 2. è©³ç´°æ¨¡æ…‹è¦–çª—

#### 2.1 å¸ƒå±€åˆ†å‰²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨™é¡Œ: Agentåç¨± (ç­–ç•¥è‰²å½©) + é—œé–‰æŒ‰éˆ•                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚     åœ–è¡¨èˆ‡æ•¸æ“šå€      â”‚ â”‚        æŒè‚¡èˆ‡æ­·å²å€         â”‚ â”‚
â”‚ â”‚                       â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚ â”‚  â”‚ ç¸½è³‡ç”¢|æç›Š|ç¾é‡‘ â”‚   â”‚ â”‚  â”‚      æŒæœ‰è‚¡ç¥¨       â”‚    â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚  â”‚  - 2330 å°ç©é›»      â”‚    â”‚ â”‚
â”‚ â”‚                       â”‚ â”‚  â”‚  - 2317 é´»æµ·        â”‚    â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚ â”‚  â”‚                 â”‚   â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚  â”‚   Chart.jsåœ–è¡¨  â”‚   â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚ â”‚  â”‚                 â”‚   â”‚ â”‚  â”‚      äº¤æ˜“æ­·å²       â”‚    â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚  â”‚  [æ™‚é–“] BUY 2330    â”‚    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  [æ™‚é–“] SELL 2317   â”‚    â”‚ â”‚
â”‚                           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. è¨­å®šç®¡ç†ä»‹é¢ (åŸºæ–¼å‰ç«¯åŸå‹)

#### 3.1 Agent ç®¡ç†åŠŸèƒ½

- **Agent åˆ—è¡¨**: é¡¯ç¤ºæ‰€æœ‰å·²å‰µå»ºçš„ Agent åŠå…¶ç‹€æ…‹
- **ç·¨è¼¯åŠŸèƒ½**: ä¿®æ”¹ Agent é…ç½®
- **åˆªé™¤åŠŸèƒ½**: ç§»é™¤ Agent åŠå…¶æ‰€æœ‰è³‡æ–™
- **æ–°å¢åŠŸèƒ½**: å‰µå»ºæ–°çš„ AI Agent

#### 3.2 æ–°å¢/ç·¨è¼¯ Agent è¡¨å–®

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ–°å¢/ç·¨è¼¯ AI Agent           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent åç¨±: [è¼¸å…¥æ¡†]                    â”‚
â”‚  AI æ¨¡å‹:    [ä¸‹æ‹‰é¸å–®] GPT-4o-mini     â”‚
â”‚                â—‹ GPT-4o-mini           â”‚
â”‚                â—‹ GPT-4o                â”‚
â”‚                â—‹ DeepSeek              â”‚
â”‚                â—‹ Grok                  â”‚
â”‚                â—‹ Gemini                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç­–ç•¥ Prompt: [å¤§å‹æ–‡å­—æ¡†]               â”‚
â”‚  [é è¨­æ¨¡æ¿] [ç©©å¥å‹] [ç©æ¥µå‹] [åƒ¹å€¼æŠ•è³‡]  â”‚
â”‚                                         â”‚
â”‚  ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„æŠ•è³‡è€…...                â”‚
â”‚  (æ”¯æ´å®Œå…¨è‡ªè¨‚æŠ•è³‡ç­–ç•¥æè¿°)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»é«”é¡è‰²:   [é¡è‰²é¸æ“‡å™¨] #22C55E        â”‚
â”‚  åˆå§‹è³‡é‡‘:   [æ•¸å­—è¼¸å…¥] 1,000,000 TWD   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·¥å…·é…ç½®: æ‰€æœ‰å¯ç”¨å·¥å…· (è‡ªå‹•é…ç½®)        â”‚
â”‚  â€¢ Market MCP Server                   â”‚
â”‚  â€¢ WebSearch Tool                      â”‚
â”‚  â€¢ é‡‘èç ”ç©¶å“¡ Agent                     â”‚
â”‚  â€¢ äº¤æ˜“é©—è­‰å·¥å…·                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          [é‡è¨­ Prompt] [å–æ¶ˆ] [å„²å­˜]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3 ç­–ç•¥æ­·å²è¿½è¹¤

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Agent ç­–ç•¥èª¿æ•´æ­·å²             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [2025-01-10 14:30] ç­–ç•¥è‡ªä¸»èª¿æ•´         â”‚
â”‚  è®Šæ›´åŸå› : å¸‚å ´æ³¢å‹•åŠ åŠ‡ï¼Œé™ä½é¢¨éšªåå¥½    â”‚
â”‚  AI åˆ†æ: åŸºæ–¼è¿‘æœŸæŠ€è¡“æŒ‡æ¨™å’Œå¸‚å ´æ•¸æ“š...  â”‚
â”‚  [æŸ¥çœ‹å®Œæ•´ Prompt è®Šæ›´]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [2025-01-08 10:15] æ‰‹å‹•ç­–ç•¥é‡è¨­         â”‚
â”‚  è®Šæ›´åŸå› : ä½¿ç”¨è€…é‡è¨­ç‚ºç©©å¥å‹æ¨¡æ¿        â”‚
â”‚  [æŸ¥çœ‹è®Šæ›´è©³æƒ…]                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [åŒ¯å‡ºæ­·å²] [é‡è¨­ç‚ºåˆå§‹ Prompt] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆè¦æ ¼

### 1. æ–·é»è¨­å®š

```css
/* æ‰‹æ©Ÿç‰ˆ */
@media (max-width: 768px) {
  .agent-grid {
    grid-template-columns: 1fr;
  }
}

/* å¹³æ¿ç‰ˆ */
@media (min-width: 769px) and (max-width: 1024px) {
  .agent-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* æ¡Œé¢ç‰ˆ */
@media (min-width: 1025px) {
  .agent-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}
```

### 2. äº’å‹•è¨­è¨ˆ

- **æ‡¸åœæ•ˆæœ**: å¡ç‰‡é‚Šæ¡†é«˜äº®
- **é»æ“Šåé¥‹**: æŒ‰éˆ•æŒ‰ä¸‹å‹•ç•«
- **è¼‰å…¥ç‹€æ…‹**: éª¨æ¶å±é¡¯ç¤º
- **äº¤æ˜“å‹•ç•«**: é–ƒçˆæ•ˆæœè¡¨ç¤ºäº¤æ˜“åŸ·è¡Œ

---

## ğŸš€ é–‹ç™¼é‡Œç¨‹ç¢‘

### Phase 0: Hosted Tools POC ç ”ç©¶ (Week 0)

**ç›®æ¨™**: é©—è­‰ OpenAI Agent SDK Hosted Tools åœ¨é‡‘èäº¤æ˜“å ´æ™¯çš„å¯è¡Œæ€§

#### 0.1 å·¥å…·èƒ½åŠ›é©—è­‰ç ”ç©¶

**CodeInterpreterTool é‡‘èè¨ˆç®—é©—è­‰**ï¼š

- [ ] æ¸¬è©¦ Python é‡‘èå¥—ä»¶æ”¯æ´åº¦ï¼ˆpandas, numpy, talibï¼‰
- [ ] é©—è­‰æŠ€è¡“æŒ‡æ¨™è¨ˆç®—èƒ½åŠ›ï¼ˆRSI, MACD, å¸ƒæ—é€šé“ï¼‰
- [ ] æ¸¬è©¦è‚¡åƒ¹æ•¸æ“šè™•ç†å’Œè¦–è¦ºåŒ–åŠŸèƒ½
- [ ] è©•ä¼°åŸ·è¡Œæ™‚é–“é™åˆ¶å’Œæ€§èƒ½è¡¨ç¾
- [ ] æ¸¬è©¦æ•¸æ“šæŒä¹…åŒ–èƒ½åŠ›

**FileSearchTool ä¸­æ–‡é‡‘èå…§å®¹æª¢ç´¢é©—è­‰**ï¼š

- [ ] å»ºç«‹æ¸¬è©¦ç”¨ Vector Storeï¼ˆå°ç£å…¬å¸è²¡å ±ã€ç ”ç©¶å ±å‘Šï¼‰
- [ ] æ¸¬è©¦ä¸­æ–‡é‡‘èå…§å®¹çš„æª¢ç´¢æº–ç¢ºåº¦
- [ ] è©•ä¼°æª”æ¡ˆæ ¼å¼æ”¯æ´ï¼ˆPDFè²¡å ±ã€Excelæ•¸æ“šï¼‰
- [ ] åˆ†æèªç¾©æœå°‹æ•ˆæœå’Œç›¸é—œæ€§è©•åˆ†
- [ ] è©•ä¼°å»ºç½®å’Œç¶­è­·æˆæœ¬

**HostedMCPTool å¤–éƒ¨æœå‹™æ•´åˆç ”ç©¶**ï¼š

- [ ] èª¿ç ”æ”¯æ´ MCP å”è­°çš„é‡‘èæ•¸æ“šæä¾›å•†
- [ ] æ¸¬è©¦å¤–éƒ¨ API èªè­‰å’Œå®‰å…¨æ©Ÿåˆ¶
- [ ] é©—è­‰æ•¸æ“šæ ¼å¼æ¨™æº–åŒ–å¯èƒ½æ€§
- [ ] è©•ä¼°æœå‹™å»¶é²å’Œå¯é æ€§æŒ‡æ¨™
- [ ] åˆ†ææ•´åˆè¤‡é›œåº¦å’Œç¶­è­·æˆæœ¬

**LocalShellTool å®‰å…¨æ€§è©•ä¼°**ï¼š

- [ ] åˆ†æ AI Agent åŸ·è¡Œ shell å‘½ä»¤çš„å®‰å…¨é¢¨éšª
- [ ] ç ”ç©¶æ¬Šé™æ§åˆ¶å’Œå‘½ä»¤ç¯„åœé™åˆ¶æ©Ÿåˆ¶
- [ ] æ¸¬è©¦è·¨å¹³å°ç›¸å®¹æ€§å•é¡Œ
- [ ] è©•ä¼°åœ¨ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²çš„å¯è¡Œæ€§

#### 0.2 å·¥å…·çµ„åˆæ•ˆæœæ¸¬è©¦

- [ ] å»ºç«‹ POC æ¸¬è©¦ç’°å¢ƒ
- [ ] è¨­è¨ˆè¤‡åˆä»»å‹™æ¸¬è©¦æ¡ˆä¾‹
- [ ] æ¸¬è©¦å¤šå·¥å…·å”ä½œçš„å¯¦éš›æ•ˆæœ
- [ ] è©•ä¼°å·¥å…·é–“æ•¸æ“šå‚³éçš„æ•ˆç‡
- [ ] åˆ†æéŒ¯èª¤è™•ç†å’Œé™ç´šæ©Ÿåˆ¶

#### 0.3 æˆæœ¬æ•ˆç›Šåˆ†æ

- [ ] è¨ˆç®— hosted tools çš„ä½¿ç”¨æˆæœ¬
- [ ] è©•ä¼°é–‹ç™¼å’Œç¶­è­·å·¥ä½œé‡
- [ ] èˆ‡ç¾æœ‰ custom tools é€²è¡Œæ•ˆèƒ½æ¯”è¼ƒ
- [ ] åˆ¶å®šå·¥å…·å°å…¥çš„å„ªå…ˆé †åºå’Œç­–ç•¥

#### 0.4 æŠ€è¡“æ¶æ§‹èª¿æ•´

- [ ] æ ¹æ“š POC çµæœæ›´æ–°ç³»çµ±æ¶æ§‹è¨­è¨ˆ
- [ ] èª¿æ•´ Agent å·¥å…·é…ç½®ç­–ç•¥
- [ ] æ›´æ–°é¢¨éšªæ§åˆ¶å’Œå®‰å…¨æ©Ÿåˆ¶
- [ ] åˆ¶å®šåˆ†éšæ®µå°å…¥è¨ˆç•«

**é æœŸç”¢å‡º**ï¼š

- Hosted Tools å¯è¡Œæ€§è©•ä¼°å ±å‘Š
- å·¥å…·èƒ½åŠ›å°ç…§è¡¨å’Œé™åˆ¶èªªæ˜
- æ›´æ–°çš„æŠ€è¡“æ¶æ§‹è¨­è¨ˆ
- Phase 1-6 é–‹ç™¼è¨ˆç•«èª¿æ•´å»ºè­°

### Phase 1: OpenAI Agent SDK åŸºç¤æ•´åˆ (Week 1-2)

- [ ] è¨­ç½® OpenAI Agents Python SDK ç’°å¢ƒ
- [ ] å¯¦ç¾ SQLiteSession æœƒè©±ç®¡ç†ç³»çµ±
- [ ] å»ºç«‹åŸºç¤ Agent æ¡†æ¶å’Œå·¥å…·ç®¡ç†å™¨
- [ ] æ•´åˆç¾æœ‰ Market MCP Server ä½œç‚º Agent å·¥å…·
- [ ] å¯¦ç¾äº¤æ˜“æ™‚é–“å’Œè³‡é‡‘é©—è­‰å·¥å…·

### Phase 2: AI ä»£ç†äººæ ¸å¿ƒåŠŸèƒ½ (Week 3-4)

- [ ] å¯¦ç¾äº¤æ˜“ä»£ç†äººæ ¸å¿ƒé‚è¼¯
- [ ] å»ºç«‹æŠ•è³‡ç­–ç•¥ç³»çµ±ï¼ˆç©©å¥å‹ã€ç©æ¥µå‹ç­‰ï¼‰
- [ ] æ•´åˆ WebSearch å·¥å…·å’Œé‡‘èç ”ç©¶å“¡ Agent
- [ ] å¯¦ç¾æ±ºç­–è¨˜éŒ„å’ŒæŠ•è³‡åŸå› æŒä¹…åŒ–
- [ ] å»ºç«‹é¢¨éšªè©•ä¼°å’ŒæŠ•è³‡çµ„åˆç®¡ç†ç³»çµ±

### Phase 3: Web æœå‹™å±¤èˆ‡å‰ç«¯åŸºç¤ (Week 5)

- [ ] å»ºç«‹ FastAPI å¾Œç«¯æœå‹™æ¶æ§‹
- [ ] å¯¦ç¾ WebSocket å³æ™‚é€šä¿¡ç³»çµ±
- [ ] å»ºç«‹å‰ç«¯åŸºç¤çµæ§‹ï¼ˆVanilla JS + Tailwindï¼‰
- [ ] å¯¦ç¾ä»£ç†äºº CRUD API
- [ ] å»ºç«‹åŸºæœ¬çš„å„€è¡¨æ¿ç•Œé¢

### Phase 4: å‰ç«¯é€²éšåŠŸèƒ½èˆ‡è¨­å®šç•Œé¢ (Week 6)

- [ ] å¯¦ç¾ AI æ¨¡å‹é¸æ“‡ç•Œé¢
- [ ] å»ºç«‹ç­–ç•¥é…ç½®å’Œæ­·å²è¿½è¹¤åŠŸèƒ½
- [ ] å¯¦ç¾å·¥å…·é…ç½®ç®¡ç†ç•Œé¢
- [ ] æ•´åˆ Chart.js åœ–è¡¨è¦–è¦ºåŒ–
- [ ] æ·»åŠ å³æ™‚äº¤æ˜“å‹•ç•«æ•ˆæœ

### Phase 5: é€²éšåˆ†æèˆ‡å„ªåŒ– (Week 7-8)

- [ ] å¯¦ç¾ç­–ç•¥å‹•æ…‹èª¿æ•´åŠŸèƒ½
- [ ] å»ºç«‹å¤šä»£ç†äººå”ä½œæ©Ÿåˆ¶
- [ ] æ·»åŠ æ•ˆèƒ½åˆ†æå’Œå›æ¸¬åŠŸèƒ½
- [ ] å¯¦ç¾é¢¨éšªæ§åˆ¶å’Œé è­¦ç³»çµ±
- [ ] å„ªåŒ–ç”¨æˆ¶é«”é©—å’ŒéŸ¿æ‡‰å¼è¨­è¨ˆ

### Phase 6: ç”Ÿç”¢éƒ¨ç½²èˆ‡ç›£æ§ (Week 9+)

- [ ] å¯¦ç¾ç³»çµ±ç›£æ§å’Œæ—¥èªŒè¨˜éŒ„
- [ ] å»ºç«‹è‡ªå‹•åŒ–æ¸¬è©¦å¥—ä»¶
- [ ] éƒ¨ç½²é…ç½®å’Œ CI/CD è¨­ç½®
- [ ] æ•ˆèƒ½å„ªåŒ–å’Œå£“åŠ›æ¸¬è©¦
- [ ] æ–‡æª”å®Œå–„å’Œä½¿ç”¨è€…æŒ‡å—

---

## ğŸ”§ æŠ€è¡“å¯¦ç¾ç´°ç¯€

### 1. å°ˆæ¡ˆç›®éŒ„çµæ§‹

```text
CasualTrader/
â”œâ”€â”€ src/                        # ä¸»è¦åŸå§‹ç¢¼ç›®éŒ„
â”‚   â”œâ”€â”€ agent/                  # AI ä»£ç†äººå±¤
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ trading_agent.py    # äº¤æ˜“ä»£ç†äººæ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ research_agent.py   # é‡‘èç ”ç©¶å“¡ä»£ç†äºº
â”‚   â”‚   â”œâ”€â”€ agent_manager.py    # ä»£ç†äººç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ session_manager.py  # SQLiteSession ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ prompts/            # ç­–ç•¥ Prompt Templates
â”‚   â”‚   â”‚   â”œâ”€â”€ conservative_strategy.txt    # ç©©å¥å‹ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ aggressive_strategy.txt      # ç©æ¥µå‹ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ balanced_strategy.txt        # å¹³è¡¡å‹ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ value_investing.txt          # åƒ¹å€¼æŠ•è³‡ç­–ç•¥
â”‚   â”‚   â”‚   â””â”€â”€ momentum_trading.txt         # å‹•é‡äº¤æ˜“ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ specialist_agents/  # å°ˆæ¥­åŠŸèƒ½ Agent (Agent-as-Tool)
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ research_agent.py      # é‡‘èç ”ç©¶å“¡ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ technical_agent.py     # æŠ€è¡“åˆ†æå¸« Agent
â”‚   â”‚   â”‚   â””â”€â”€ risk_agent.py          # é¢¨éšªè©•ä¼°å¸« Agent
â”‚   â”‚   â””â”€â”€ tools/              # åŸºç¤å·¥å…·é›†
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ market_tools.py        # å¸‚å ´ MCP å·¥å…·åŒ…è£
â”‚   â”‚       â”œâ”€â”€ validation_tools.py    # é©—è­‰å·¥å…· (æ™‚é–“ã€è³‡é‡‘)
â”‚   â”‚       â””â”€â”€ portfolio_tools.py     # æŠ•è³‡çµ„åˆç®¡ç†å·¥å…·
â”‚   â”œâ”€â”€ backend/                # Web æœå‹™å±¤
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py            # FastAPI æ‡‰ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ api/               # REST API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ agents.py      # ä»£ç†äºº API
â”‚   â”‚   â”‚   â”œâ”€â”€ trading.py     # äº¤æ˜“ API
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.py   # æŠ•è³‡çµ„åˆ API
â”‚   â”‚   â”‚   â””â”€â”€ settings.py    # è¨­å®š API
â”‚   â”‚   â”œâ”€â”€ websocket/         # WebSocket è™•ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ connection.py  # é€£ç·šç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ events.py      # äº‹ä»¶è™•ç†
â”‚   â”‚   â”‚   â””â”€â”€ handlers.py    # äº‹ä»¶è™•ç†å™¨
â”‚   â”‚   â”œâ”€â”€ models/            # è³‡æ–™æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ agent.py       # ä»£ç†äººæ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ trading.py     # äº¤æ˜“æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.py   # æŠ•è³‡çµ„åˆæ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ market.py      # å¸‚å ´è³‡æ–™æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/          # æ¥­å‹™é‚è¼¯æœå‹™
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ agent_service.py # ä»£ç†äººæœå‹™
â”‚   â”‚   â”‚   â”œâ”€â”€ trading_service.py # äº¤æ˜“æœå‹™
â”‚   â”‚   â”‚   â””â”€â”€ validation_service.py # é©—è­‰æœå‹™
â”‚   â”‚   â””â”€â”€ database/          # è³‡æ–™åº«æ“ä½œ
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ connection.py  # è³‡æ–™åº«é€£ç·š
â”‚   â”‚       â”œâ”€â”€ models.py      # SQLAlchemy æ¨¡å‹
â”‚   â”‚       â””â”€â”€ repositories.py # è³‡æ–™å­˜å–å±¤
â”‚   â””â”€â”€ frontend/              # å‰ç«¯æ‡‰ç”¨
â”‚       â”œâ”€â”€ index.html         # ä¸»å„€è¡¨æ¿é é¢
â”‚       â”œâ”€â”€ settings.html      # è¨­å®šé é¢
â”‚       â”œâ”€â”€ js/                # JavaScript æ¨¡çµ„
â”‚       â”‚   â”œâ”€â”€ main.js        # ä¸»è¦æ‡‰ç”¨é‚è¼¯
â”‚       â”‚   â”œâ”€â”€ agents.js      # ä»£ç†äººç®¡ç†
â”‚       â”‚   â”œâ”€â”€ dashboard.js   # å„€è¡¨æ¿åŠŸèƒ½
â”‚       â”‚   â”œâ”€â”€ settings.js    # è¨­å®šç®¡ç†
â”‚       â”‚   â”œâ”€â”€ charts.js      # åœ–è¡¨åŠŸèƒ½
â”‚       â”‚   â”œâ”€â”€ websocket.js   # WebSocket å®¢æˆ¶ç«¯
â”‚       â”‚   â””â”€â”€ utils.js       # å·¥å…·å‡½æ•¸
â”‚       â”œâ”€â”€ css/               # æ¨£å¼æª”æ¡ˆ
â”‚       â”‚   â”œâ”€â”€ main.css       # ä¸»è¦æ¨£å¼
â”‚       â”‚   â”œâ”€â”€ dashboard.css  # å„€è¡¨æ¿æ¨£å¼
â”‚       â”‚   â”œâ”€â”€ settings.css   # è¨­å®šé é¢æ¨£å¼
â”‚       â”‚   â””â”€â”€ components.css # çµ„ä»¶æ¨£å¼
â”‚       â””â”€â”€ assets/            # éœæ…‹è³‡æº
â”‚           â”œâ”€â”€ icons/         # åœ–æ¨™æª”æ¡ˆ
â”‚           â”œâ”€â”€ images/        # åœ–ç‰‡è³‡æº
â”‚           â””â”€â”€ fonts/         # å­—é«”æª”æ¡ˆ
â”œâ”€â”€ market_mcp/                # MCP Server (ç¾æœ‰)
â”‚   â””â”€â”€ ...                    # ç¾æœ‰ MCP æœå‹™ä»£ç¢¼
â”œâ”€â”€ tests/                     # æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ test_agents/
â”‚   â”œâ”€â”€ test_backend/
â”‚   â””â”€â”€ test_integration/
â”œâ”€â”€ docs/                      # æ–‡ä»¶
â”œâ”€â”€ scripts/                   # éƒ¨ç½²èˆ‡å·¥å…·è…³æœ¬
â””â”€â”€ requirements.txt           # Python ä¾è³´
```

### 2. ç’°å¢ƒè¨­å®š

```bash
# æ ¸å¿ƒä¾è³´
fastapi[all]>=0.104.0
openai-agents-python>=0.2.9
websockets>=11.0
uvicorn[standard]>=0.24.0
pydantic>=2.0.0
sqlalchemy>=2.0.0

# AI æ¨¡å‹ SDK
openai>=1.0.0
anthropic>=0.8.0  # å¦‚æœä½¿ç”¨ Claude
requests>=2.31.0  # WebSearch å·¥å…·

# æ™‚é–“èˆ‡é©—è­‰
python-dateutil>=2.8.0
pytz>=2023.3  # å°ç£æ™‚å€æ”¯æ´

# é–‹ç™¼å·¥å…·
pytest>=7.4.0
pytest-asyncio>=0.21.0
black>=23.0.0
ruff>=0.1.0
mypy>=1.5.0

# æ¸¬è©¦å·¥å…·
httpx>=0.25.0  # FastAPI æ¸¬è©¦å®¢æˆ¶ç«¯
pytest-mock>=3.11.0
```

### 3. Agent å·¥å…·é…ç½®è¦æ ¼

#### 3.1 å·¥å…·è¨»å†Šèˆ‡ç®¡ç†

```python
from agents import Agent
from typing import List, Dict, Any

class ToolManager:
    """ä»£ç†äººå·¥å…·ç®¡ç†å™¨"""

    def __init__(self):
        self.available_tools = {
            "market_mcp": MarketMCPTool(),
            "websearch": WebSearchTool(),
            "research_agent": ResearchAgentTool(),
            "fund_validator": FundValidatorTool(),
            "time_validator": TimeValidatorTool(),
            "risk_calculator": RiskCalculatorTool(),
            "portfolio_manager": PortfolioManagerTool(),
            "strategy_advisor": StrategyAdvisorTool()
        }

    def configure_agent_tools(self, agent: Agent, tool_config: List[Dict[str, Any]]):
        """ç‚ºä»£ç†äººé…ç½®å·¥å…·"""
        for config in tool_config:
            tool_name = config["tool_name"]
            if tool_name in self.available_tools and config["enabled"]:
                tool = self.available_tools[tool_name]
                tool.configure(config.get("config", {}))
                agent.add_tool(tool)

class MarketMCPTool:
    """Market MCP Server å·¥å…·åŒ…è£"""

    def __init__(self):
        self.name = "market_data"
        self.description = "å°ç£è‚¡ç¥¨å¸‚å ´æ•¸æ“šæŸ¥è©¢èˆ‡äº¤æ˜“åŸ·è¡Œ"

    async def get_stock_price(self, symbol: str) -> dict:
        """å–å¾—è‚¡ç¥¨å³æ™‚åƒ¹æ ¼"""
        # å‘¼å«ç¾æœ‰çš„ market-mcp-server
        pass

    async def execute_trade(self, symbol: str, action: str, quantity: int) -> dict:
        """åŸ·è¡Œè‚¡ç¥¨äº¤æ˜“"""
        # æ•´åˆäº¤æ˜“é©—è­‰èˆ‡åŸ·è¡Œé‚è¼¯
        pass

class WebSearchTool:
    """ç¶²è·¯æœå°‹å·¥å…·"""

    def __init__(self):
        self.name = "web_search"
        self.description = "æœå°‹ç¶²è·¯ä¸Šçš„è‚¡å¸‚ç›¸é—œè³‡è¨Š"

    async def search_market_news(self, query: str) -> List[dict]:
        """æœå°‹å¸‚å ´æ–°è"""
        pass

    async def search_company_info(self, symbol: str) -> dict:
        """æœå°‹å…¬å¸åŸºæœ¬è³‡è¨Š"""
        pass
```

#### 3.2 äº¤æ˜“æ™‚é–“èˆ‡è³‡é‡‘é©—è­‰å·¥å…·

```python
import pytz
from datetime import datetime, time

class TimeValidatorTool:
    """äº¤æ˜“æ™‚é–“é©—è­‰å·¥å…·"""

    def __init__(self):
        self.taiwan_tz = pytz.timezone('Asia/Taipei')
        self.trading_start = time(9, 0)    # 09:00
        self.trading_end = time(13, 30)    # 13:30
        self.trading_days = [0, 1, 2, 3, 4]  # é€±ä¸€åˆ°é€±äº”

    async def validate_trading_time(self) -> dict:
        """é©—è­‰ç•¶å‰æ˜¯å¦ç‚ºäº¤æ˜“æ™‚é–“"""
        now = datetime.now(self.taiwan_tz)

        is_trading_day = now.weekday() in self.trading_days
        is_trading_hours = self.trading_start <= now.time() <= self.trading_end

        return {
            "is_valid": is_trading_day and is_trading_hours,
            "current_time": now.isoformat(),
            "is_trading_day": is_trading_day,
            "is_trading_hours": is_trading_hours,
            "next_trading_session": self._get_next_trading_session(now)
        }

class FundValidatorTool:
    """è³‡é‡‘é©—è­‰å·¥å…·"""

    async def validate_purchase_funds(self, agent_id: str, symbol: str,
                                    quantity: int, price: float) -> dict:
        """é©—è­‰è²·å…¥è³‡é‡‘æ˜¯å¦å……è¶³"""
        # è¨ˆç®—æ‰€éœ€è³‡é‡‘ï¼ˆå«æ‰‹çºŒè²»ï¼‰
        total_cost = quantity * price * 1.002  # 0.2% æ‰‹çºŒè²»

        # æŸ¥è©¢ä»£ç†äººç¾é‡‘é¤˜é¡
        portfolio = await self.get_agent_portfolio(agent_id)
        cash_balance = portfolio.cash_balance

        return {
            "is_sufficient": cash_balance >= total_cost,
            "required_amount": total_cost,
            "available_cash": cash_balance,
            "shortfall": max(0, total_cost - cash_balance)
        }
```

### 3. éƒ¨ç½²é…ç½®

```yaml
# docker-compose.yml
version: "3.8"
services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=sqlite:///./accounts.db
    volumes:
      - ./data:/app/data
```

---

## ğŸ“Š æ•ˆèƒ½èˆ‡ç›£æ§

### 1. æ•ˆèƒ½æŒ‡æ¨™

- **WebSocket å»¶é²**: < 100ms
- **API éŸ¿æ‡‰æ™‚é–“**: < 500ms
- **ä¸¦ç™¼ç”¨æˆ¶**: æ”¯æ´ 100+ åŒæ™‚é€£ç·š
- **è³‡æ–™æ›´æ–°é »ç‡**: æ¯ 5 ç§’ä¸€æ¬¡

### 2. ç›£æ§æ©Ÿåˆ¶

- **æ‡‰ç”¨ç¨‹å¼ç›£æ§**: è¨˜éŒ„ API å‘¼å«å’ŒéŒ¯èª¤
- **AI ä»£ç†äººç›£æ§**: è¿½è¹¤æ±ºç­–æ™‚é–“å’ŒæˆåŠŸç‡
- **äº¤æ˜“ç›£æ§**: è¨˜éŒ„æ‰€æœ‰äº¤æ˜“æ“ä½œ
- **ç³»çµ±è³‡æºç›£æ§**: CPUã€è¨˜æ†¶é«”ä½¿ç”¨æƒ…æ³

### 3. éŒ¯èª¤è™•ç†

- **API éŒ¯èª¤**: æ¨™æº–åŒ–éŒ¯èª¤éŸ¿æ‡‰æ ¼å¼
- **WebSocket æ–·ç·š**: è‡ªå‹•é‡é€£æ©Ÿåˆ¶
- **AI ä»£ç†äººéŒ¯èª¤**: å„ªé›…é™ç´šå’ŒéŒ¯èª¤å ±å‘Š
- **è³‡æ–™åº«éŒ¯èª¤**: äº‹å‹™å›æ»¾å’Œè³‡æ–™ä¸€è‡´æ€§

---

## ğŸ”’ å®‰å…¨æ€§è€ƒé‡

### 1. è³‡æ–™å®‰å…¨

- **è¼¸å…¥é©—è­‰**: æ‰€æœ‰ç”¨æˆ¶è¼¸å…¥é€²è¡Œé©—è­‰
- **SQL æ³¨å…¥é˜²è­·**: ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢
- **XSS é˜²è­·**: è¼¸å‡ºç·¨ç¢¼å’Œ CSP è¨­å®š

### 2. API å®‰å…¨

- **CORS è¨­å®š**: é™åˆ¶å…è¨±çš„ä¾†æº
- **Rate Limiting**: API å‘¼å«é »ç‡é™åˆ¶
- **é©—è­‰æ©Ÿåˆ¶**: åŸºæœ¬çš„èº«ä»½é©—è­‰ï¼ˆæœªä¾†æ“´å±•ï¼‰

### 3. è³‡æ–™éš±ç§

- **æ—¥èªŒç®¡ç†**: ä¸è¨˜éŒ„æ•æ„Ÿè³‡è¨Š
- **è³‡æ–™æ¸…ç†**: å®šæœŸæ¸…ç†éæœŸè³‡æ–™
- **å‚™ä»½ç­–ç•¥**: å®šæœŸå‚™ä»½é‡è¦è³‡æ–™

---

## ğŸ“„ é™„éŒ„

### A. åƒè€ƒè³‡æ–™

- [FastAPI å®˜æ–¹æ–‡æª”](https://fastapi.tiangolo.com/)
- [Chart.js å®˜æ–¹æŒ‡å—](https://www.chartjs.org/docs/)
- [WebSocket API è¦ç¯„](https://websockets.spec.whatwg.org/)
- [å°ç£è­‰äº¤æ‰€ API](https://www.twse.com.tw/)

### B. è¡“èªå®šç¾©

- **AI ä»£ç†äºº**: ä½¿ç”¨äººå·¥æ™ºèƒ½é€²è¡Œäº¤æ˜“æ±ºç­–çš„è‡ªå‹•åŒ–ç¨‹å¼
- **MCP**: Model Context Protocolï¼Œç”¨æ–¼æ¨¡å‹é–“é€šä¿¡çš„å”è­°
- **WebSocket**: é›™å‘é€šä¿¡å”è­°ï¼Œç”¨æ–¼å³æ™‚è³‡æ–™æ¨é€
- **Chart.js**: JavaScript åœ–è¡¨åº«

### C. è®Šæ›´è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ       | è®Šæ›´å…§å®¹ | ä½œè€…   |
| ---- | ---------- | -------- | ------ |
| 1.0  | 2025-01-10 | åˆå§‹ç‰ˆæœ¬ | Claude |

---

**æ–‡ä»¶ç‹€æ…‹**: ğŸ”„ å¾…ç¢ºèª
**ä¸‹ä¸€æ­¥**: ç­‰å¾…ç¢ºèªå¾Œé–‹å§‹ Phase 1 é–‹ç™¼
